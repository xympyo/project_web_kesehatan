<!doctype html>
<html>

<head>
    <!-- Copy This Below -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="turn.min.js"></script>

    <style type="text/css">
        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Copy all of this below */

        #magazine {
            background: rgb(39, 174, 96);
            background: linear-gradient(90deg, rgba(39, 174, 96, 1) 0%, rgba(39, 174, 163, 1) 50%, rgba(50, 174, 39, 1) 100%);
            height: 75vh;
            box-shadow: 0px 0px 16px 0px rgba(0, 0, 0, 0.50);
        }

        #magazine .turn-page {
            background-color: #ffffff;
            box-shadow: 80px 0px 120px 0px rgba(0, 0, 0, 0.16) inset;
        }

        .page-even {
            box-shadow: 80px 0px 120px 0px rgba(0, 0, 0, 0.16) inset;
        }

        .page-odd {
            box-shadow: -80px 0px 120px 0px rgba(0, 0, 0, 0.16) inset;
        }

        input[type="range"]::-webkit-slider-runnable-track {
            background: #27AE60;
            border-radius: .25rem;
            padding: .1rem;
        }
    </style>

    <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="global.css">
    <!-- Copy only this -->
    <link rel="stylesheet" href="flipbookcss.css">
</head>

<body>
    <!-- COPY first, then change content -->
    <div class="flipbook-section container">
        <div id="magazine">
            <div>
                <div class="container d-flex flex-column">
                    <audio id="audioPlayer">
                        <source src="./assets/audio/bab1.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>

                    <div class="row">
                        <div class="col-2"></div>
                        <div class="col-8 p-5">
                            <div class="mp3-container p-3"
                                style="background-color: #1f2b24; border-radius: .5rem; filter: drop-shadow(0rem .5rem .75rem #000000);">
                                <div class="row">
                                    <div class="col-3"></div>
                                    <div class="col-6">
                                        <img id="myImage" src="./assets/illustration/hero_section 1.png"
                                            class="img-fluid" alt="">
                                    </div>
                                    <div class="col-3"></div>
                                </div>
                                <div class="row d-flex justify-content-center align-items-center mt-3">
                                    <p class="desc primary poppins-regular text-center"><span
                                            id="currentTime">0:00</span>
                                    </p>
                                    <input type="range" id="progressBar" value="0" max="100"
                                        style="width: max-content;">
                                </div>
                                <div class="row d-flex justify-content-center align-items-center mt-3">
                                    <div class="col-5"></div>
                                    <div class="col-2">
                                        <img id="playButton" style="cursor: pointer;" src="./assets/icon/play_icon.png"
                                            class="img-fluid" alt="">
                                    </div>
                                    <div class="col-5"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- script for audio player -->
    <script>
        const audioPlayer = document.getElementById("audioPlayer");
        const playButton = document.getElementById("playButton");
        const currentTimeDisplay = document.getElementById("currentTime");
        const totalTimeDisplay = document.getElementById("totalTime");
        const progressBar = document.getElementById("progressBar");

        // update total duration
        audioPlayer.addEventListener('loadedmetadata', () => {
            totalTimeDisplay.textContent = formatTime(audioPlayer.duration);
            progressBar.max = Math.floor(audioPlayer.duration);
        });

        // play on click
        playButton.addEventListener('click', () => {
            isRotating = !isRotating;
            if (audioPlayer.paused) {
                audioPlayer.play();
                rotateImg();
                playButton.src = "./assets/icon/pause_icon.png";
            } else {
                audioPlayer.pause();
                playButton.src = "./assets/icon/play_icon.png";
            }
        });

        // update current time and progress bar
        audioPlayer.addEventListener('timeupdate', () => {
            currentTimeDisplay.textContent = formatTime(audioPlayer.currentTime);
            progressBar.value = Math.floor(audioPlayer.currentTime);
        });


        // seek audio when bar changed
        progressBar.addEventListener('input', () => {
            audioPlayer.currentTime = progressBar.value;
        });

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // image rotates
        const myImage = document.getElementById("myImage");

        let rotationAngle = 0;
        let isRotating = false;

        function rotateImg() {
            if (isRotating) {
                rotationAngle = (rotationAngle + 1) % 360;
                myImage.style.transform = `rotate(${rotationAngle}deg)`;
                requestAnimationFrame(rotateImg);
            }
        }
    </script>

    <!-- Copy these belolw -->
    <script type="text/javascript">

        $(window).ready(function () {
            $('#magazine').turn({
                display: 'double',
                acceleration: true,
                gradients: !$.isTouch,
                elevation: 50,
                when: {
                    turned: function (e, page) {
                        console.log('Current view: ', $(this).turn('view'));
                    }
                }
            });
        });


        $(window).bind('keydown', function (e) {

            if (e.keyCode == 37)
                $('#magazine').turn('previous');
            else if (e.keyCode == 39)
                $('#magazine').turn('next');

        });

    </script>

</body>

</html>